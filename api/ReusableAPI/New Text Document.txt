API Reusability & Adjustments Guide

This document explains which API files from the Vatikan Archives project can be reused in other projects and what adjustments are needed.

âœ… Fully Reusable (Minimal Changes Needed)

These can be dropped into new projects with only small tweaks (like renaming routes):

_auth.js â†’ Generic auth helper.

_db.js / _pg.js â†’ Database connection utilities (adjust DB URL).

admin-login.js â†’ Works anywhere with admin login.

products.js â†’ Can be renamed to items, events, courses, etc.

cart.js â†’ Generic cart management.

orders.js â†’ Universal order storage.

contact.js â†’ Basic contact form handler.

public-settings.js â†’ Store site-wide config.

debug-echo.js â†’ Safe debug tool.

instagram-config.js & instagram-posts.js â†’ Reusable for any IG feed.

âš ï¸ Reusable but Needs Adjustments

These work across projects, but will need edits depending on business logic, database schema, or environment variables.

Payments / Checkout

create-checkout-session.js â†’ Update success/cancel redirect URLs.

create-payment-intent.js â†’ Adjust currency, amounts, metadata.

confirm-payment.js â†’ Make sure it logs orders in your DB schema.

checkout-success.js â†’ Change thank-you page / confirmation logic.

checkout-cancel.js â†’ Change redirect after cancellation.

get-checkout-session.js â†’ Ensure it matches how you store sessions.

get-stripe-config.js â†’ Update Stripe publishable key.

stripe-utils.js â†’ Usually fine, but check helper methods.

stripe-webhook.js â†’ Adjust events handled (e.g., donation, subscription).

payment-config.js â†’ Replace with your own env variables.

Admin

admin-settings.js â†’ Depends on how settings are stored in DB.

admin-stripe.js â†’ Adjust for how Stripe keys are stored.

ğŸ§ª Dev/Test Only

test-stripe.js â†’ Keep for development to confirm Stripe setup, but disable/remove in production.

âŒ Project-Specific (Not Recommended to Copy Directly)

checkout.js.disabled â†’ Deprecated.

stripe-health.js.disabled â†’ Disabled, not needed.

admin_settings_seed_int.sql â†’ Seed file for this specific site.

migrations/0001_add_products_columns.sql â†’ Schema migration tied to this DB.

README.txt â†’ Repo-specific notes.

ğŸ”‘ Summary

Safe everywhere: Auth, DB, cart, orders, contact, products, Instagram.

Needs editing: Payments, checkout flow, admin settings.

Dev only: test-stripe.js.

Skip: Old/disabled files, project-specific SQL seeds.

This way, you can reuse 80% of the API as a boilerplate, with only checkout, payments, and settings needing project-specific adjustments.